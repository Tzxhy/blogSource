---
title: 关于请求二三事
date: 2019-03-07 14:44:13
tags:
- 网络请求
categories: 网络请求
---
# 关于请求二三事
请求的方式：
1. get请求，又有几种细分的方式：
2. post请求，细分方式：
3. 表单请求（先不管分类依据是否正确）

<!-- more -->

下面分点来说：
1. 会刷新页面的有：手动输入一个URL到地址栏，按回车；也可以是FORM表单提交的GET请求。不会刷新的：ajax（fetch）方式的get（需要考虑跨域的问题）。一般来说，get请求没有请求体，所有参数都在url中能看到，并且讲道理是有长度限制的（各个浏览器限制不一样，chrome就可以好几大千字符，其他浏览器没测试）。在长请求地址时，考虑到兼容性，不要使用get的方式。使用post。
2. post也可以ajax（fetch），或者表单的POST方式（刷新页面）。对于获取数据渲染页面，使用异步获取。对于页面间传参可以使用FORM提交后刷新页面。长度任意。

关于请求要考虑的东西：
1. 请求的method，即是GET、还是POST（获取数据中常用到的请求主要是这两类），这关系到后台的数据解析方式；
2. 请求体的编码问题。


- 1就不详细说了，只要知道GET一般是从url中获取数据，没有所谓的请求体（我使用XMLHttpRequest发请求，send中加一个对象，在请求详情中并没有出现我发送的数据）。
- 对于2，在发送请求时，不同浏览器、不同操作系统，在发送包含中文等非ANSI编码的文字时，会存在对URL的编码问题。具体可看https://blog.csdn.net/liaozhongping/article/details/48543147这里。大致就是说，最好对存在中文的查询手动进行一次urlencode，以解决各浏览器编码不一致问题。


PS: 题外话，对于编码，js提供了三种，escape, encodeURI, encodeURIComponent。区别见：https://www.cnblogs.com/qiantuwuliang/archive/2009/07/19/1526687.html 。简而言之，escape针对 **非**
```txt
英文字母，数字，- _ . ! ~ * ' ( )
```
进行转码，encodeURI在escape的基础上，**增加**了对URI敏感的 
```txt
;/?:@&=+$,#
```
，这几个字符不参与转码。encodeURIComponent会转码URI敏感的那几个字符
```txt
 ;/?:@&=+$,#
 ```
 它相当于转码一个字符串，这个字符串是一个完整URI的某一部分，放在URL来说可以表达一个协议头或者某一级path或者是查询的参数等。

### 关于编码要考虑的
前端的编码正确与否，直接关系到后端的解码是否正确。比如，前端编码了两次，后端只解码了一次，能correct吗？当然不能。

### 首先需要知道的是
不管你的URL中有没有非asic字符，浏览器默认都会对URL进行编码一次，只是说，如果你的URL中只有asic字符了，比如：www.qunar.com，不管再怎么被浏览器转码都还是www.qunar.com。所以说，在存在中文参数的，可以先encodeURIComponent一遍，再被浏览器自己转码一遍。发到后端的请求地址或者参数，会被后端正确地用一次解码或者两次解码来正确接收（视后端框架是否会主动解码一次URL地址，一般来说是会的）。



### 补充已知坑
java中URLEncode.encode，会把空格变成+号，得注意。

注意好了编码的问题，让我们愉快的发送请求吧！
